
<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <div class="grid">
    <!-- Información del producto -->
    <div class="col-12">
      <orb-card>
        <div orbHeader class="flex align-items-center">
          <i class="pi pi-info-circle mr-2"></i>
          <h3 class="m-0">Información del Producto</h3>
        </div>
        <div orbBody>
          <div class="flex align-items-center gap-2 p-3 bg-blue-50 border border-blue-200 border-radius">
            <i class="pi pi-box text-blue-600"></i>
            <span class="font-semibold text-blue-800">Producto seleccionado:</span>
            <span class="text-blue-700">{{ productName }}</span>
            <span class="text-sm text-gray-500">(ID: {{ productId }})</span>
          </div>
        </div>
      </orb-card>
    </div>

    <!-- Detalles del movimiento -->
    <div class="col-12">
      <orb-card>
        <div orbHeader class="flex align-items-center">
          <i class="pi pi-arrows-h mr-2"></i>
          <h3 class="m-0">Detalles del Movimiento</h3>
        </div>
        <div orbBody class="grid">
          <!-- Tipo de movimiento -->
          <div class="field col-12">
            <orb-form-field label="Tipo de Movimiento" [required]="true">
              <orb-select
                inputId="type"
                formControlName="type"
                [options]="movementTypes"
                optionLabel="label"
                optionValue="value"
                placeholder="Selecciona un tipo de movimiento"
                styleClass="w-full"
              />

              @if (getSelectedTypeDescription()) {
                <small class="text-gray-600 mt-1 block">{{ getSelectedTypeDescription() }}</small>
              }
            </orb-form-field>
          </div>

          <!-- Cantidad -->
          <div class="field col-12 md:col-6">
            <orb-form-field label="Cantidad" [required]="true">
              <p-inputNumber
                id="quantity"
                formControlName="quantity"
                [min]="1"
                [step]="1"
                mode="decimal"
                [showButtons]="true"
                buttonLayout="horizontal"
                incrementButtonIcon="pi pi-plus"
                decrementButtonIcon="pi pi-minus"
                styleClass="w-full"
              />
            </orb-form-field>
          </div>

          <!-- Razón/Comentario -->
          <div class="field col-12">
            <orb-form-field label="Razón o Comentario">
              <orb-text-area
                formControlName="reason"
                inputId="reason"
                [rows]="3"
                [autoResize]="true"
              ></orb-text-area>
              <small class="text-gray-600 mt-1 block">Campo opcional para agregar contexto al movimiento</small>
            </orb-form-field>
          </div>
        </div>
      </orb-card>
    </div>

    <!-- Vista previa del efecto -->
    @if (form.get('type')?.value) {
      <div class="col-12">
        <orb-card>
          <div orbHeader class="flex align-items-center">
            <i class="pi pi-eye mr-2"></i>
            <h3 class="m-0">Vista Previa del Efecto</h3>
          </div>
          <div orbBody>
            <div class="flex align-items-center gap-3">
              <span class="text-gray-600">Stock del producto:</span>
              
              @if (form.get('type')?.value === 'in') {
                <span class="text-green-600 font-semibold">
                  <i class="pi pi-arrow-up mr-1"></i>
                  Se incrementará en {{ form.get('quantity')?.value || 0 }} unidades
                </span>
              }
              
              @if (form.get('type')?.value === 'out' || form.get('type')?.value === 'usage') {
                <span class="text-red-600 font-semibold">
                  <i class="pi pi-arrow-down mr-1"></i>
                  Se reducirá en {{ form.get('quantity')?.value || 0 }} unidades
                </span>
              }
              
              @if (form.get('type')?.value === 'adjustment') {
                <span class="text-blue-600 font-semibold">
                  <i class="pi pi-sliders-h mr-1"></i>
                  Se ajustará según el valor especificado
                </span>
              }
            </div>
          </div>
        </orb-card>
      </div>
    }
  </div>
</form>

<orb-form-footer
  [buttons]="footerActions"
  alignment="right"
  (actionClicked)="handleFooterAction($event)"
/>